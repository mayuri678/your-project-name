<app-header [loggedIn]="isLoggedIn" (logout)="onLogout()"></app-header>

<div class="my-templates-container">
  <!-- Edit Template Form -->
  <div class="edit-form" *ngIf="showEditForm && editingTemplate">
    <h3>Edit Template - {{ editingTemplate.name }}</h3>
    <form (ngSubmit)="updateTemplate()" class="template-form">
      <div class="form-row">
        <div class="form-group">
          <label>Template Name *</label>
          <input type="text" [(ngModel)]="editingTemplate.name" name="editName" required>
        </div>
        <div class="form-group">
          <label>Category *</label>
          <select [(ngModel)]="editingTemplate.category" name="editCategory" required>
            <option *ngFor="let category of categories" [value]="category">{{ category }}</option>
          </select>
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label>Color</label>
          <select [(ngModel)]="editingTemplate.color" name="editColor">
            <option *ngFor="let color of colors" [value]="color">{{ color }}</option>
          </select>
        </div>
        <div class="form-group">
          <label>Layout</label>
          <select [(ngModel)]="editingTemplate.layout" name="editLayout">
            <option *ngFor="let layout of layouts" [value]="layout">{{ layout }}</option>
          </select>
        </div>
      </div>
      
      <div class="form-group">
        <label>Features</label>
        <div class="features-checkboxes">
          <label class="feature-checkbox" *ngFor="let feature of features">
            <input type="checkbox" 
                   [checked]="editingTemplate.templateFeatures?.includes(feature)"
                   (change)="toggleFeature(feature)">
            <span>{{ feature }}</span>
          </label>
        </div>
      </div>
      
      <div class="form-actions">
        <button type="submit" class="submit-btn">âœ… Update Template</button>
        <button type="button" class="cancel-btn" (click)="cancelEdit()">âŒ Cancel</button>
      </div>
    </form>
  </div>

  <div class="templates-header">
    <div class="header-content">
      <div class="header-text">
        <h1 class="page-title">
          <span class="title-icon">ğŸ“„</span>
          My Templates
        </h1>
        <p class="page-subtitle">Manage and organize your saved resume templates</p>
      </div>
      <button class="create-new-btn" (click)="navigateToResume()">
        <span class="btn-icon">â•</span>
        <span class="btn-text">Create New</span>
      </button>
    </div>
  </div>

  <div class="templates-content">
    <!-- Loading State -->
    <div *ngIf="loading" class="loading-state">
      <div class="loading-spinner"></div>
      <p class="loading-text">Loading your templates...</p>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading && templates.length === 0" class="empty-state">
      <div class="empty-icon">ğŸ“‹</div>
      <h3 class="empty-title">No Templates Yet</h3>
      <p class="empty-description">You haven't saved any templates yet. Start creating your first professional resume template!</p>
      <button class="empty-action-btn" (click)="navigateToResume()">
        <span class="btn-icon">âœ¨</span>
        Create Your First Template
      </button>
    </div>

    <!-- Templates Grid -->
    <div *ngIf="!loading && templates.length > 0" class="templates-grid">
      <div *ngFor="let template of templates" class="template-card">
        <div class="card-header">
          <div class="template-icon-wrapper">
            <span class="template-icon">ğŸ“„</span>
          </div>
          <div class="template-badge">{{ template.category || 'Template' }}</div>
        </div>
        
        <div class="card-body">
          <h3 class="template-title">{{ getTemplateName(template) }}</h3>
          <div class="template-meta">
            <div class="meta-item">
              <span class="meta-icon">ğŸ“…</span>
              <span class="meta-text">{{ template.created_at | date:'MMM d, y' }}</span>
            </div>
            <div class="meta-item" *ngIf="template.updated_at">
              <span class="meta-icon">ğŸ”„</span>
              <span class="meta-text">Updated {{ template.updated_at | date:'MMM d' }}</span>
            </div>
          </div>
        </div>

        <div class="card-footer">
          <button class="action-btn view-btn" (click)="viewTemplate(template)" title="View Template">
            <span class="action-icon">ğŸ‘ï¸</span>
            <span class="action-text">View</span>
          </button>
          <button class="action-btn edit-btn" (click)="editTemplate(template)" title="Edit Template">
            <span class="action-icon">âœï¸</span>
            <span class="action-text">Edit</span>
          </button>
          <button class="action-btn delete-btn" (click)="deleteTemplate(template)" title="Delete Template">
            <span class="action-icon">ğŸ—‘ï¸</span>
            <span class="action-text">Delete</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
