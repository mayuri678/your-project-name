<div class="word-container">
  <div class="ribbon">
    <div class="ribbon-tabs">
      <button class="tab" [class.active]="activeTab === 'home'" (click)="switchTab('home')">Home</button>
      <button class="tab" [class.active]="activeTab === 'insert'" (click)="switchTab('insert')">Insert</button>
      <button class="tab" [class.active]="activeTab === 'layout'" (click)="switchTab('layout')">Layout</button>
      <button class="tab" [class.active]="activeTab === 'view'" (click)="switchTab('view')">View</button>
    </div>
    
    <div class="toolbar" *ngIf="activeTab === 'home'">
      <div class="toolbar-group">
        <label>File</label>
        <button class="save-btn" (click)="saveResume()">üíæ Save</button>
        <button class="template-btn" (click)="showTemplates()">üìã Templates</button>
        <button class="download-btn" (click)="downloadResume()">üìÑ Download</button>
        <button class="translate-btn" (click)="showTranslateDialog()">üåê Translate</button>
      </div>
      <div class="toolbar-group">
        <label>Font</label>
        <select class="font-select" (change)="changeFont($event)">
          <option value="Calibri">Calibri</option>
          <option value="Arial">Arial</option>
          <option value="Times New Roman">Times New Roman</option>
        </select>
        <select class="size-select" (change)="changeFontSize($event)">
          <option value="10">10</option>
          <option value="11" selected>11</option>
          <option value="12">12</option>
          <option value="14">14</option>
          <option value="16">16</option>
          <option value="18">18</option>
        </select>
        <button class="btn-bold" (click)="toggleBold()"><b>B</b></button>
        <button class="btn-italic" (click)="toggleItalic()"><i>I</i></button>
        <button class="btn-underline" (click)="toggleUnderline()"><u>U</u></button>
        <input type="color" class="color-picker" (change)="changeTextColor($event)" title="Text Color">
        <input type="color" class="bg-color-picker" (change)="changeBackgroundColor($event)" value="#ffffff" title="Background Color">
      </div>
      <div class="toolbar-group">
        <label>Styles</label>
        <select class="style-select" (change)="applyStyle($event)">
          <option *ngFor="let style of textStyles" [value]="style.name">{{ style.name }}</option>
        </select>
      </div>
      <div class="toolbar-group">
        <label>Add Section</label>
        <button class="add-section-btn" (click)="addSection()">+ Add Section</button>
      </div>
    </div>

    <div class="toolbar" *ngIf="activeTab === 'insert'">
      <div class="toolbar-group">
        <label>Insert</label>
        <button class="insert-btn" (click)="showTableSelector()">üìä Table</button>
        <button class="insert-btn" (click)="insertImage()">üñºÔ∏è Image</button>
        <button class="insert-btn" (click)="insertLine()">‚ûñ Line</button>
      </div>
      <div class="table-selector" *ngIf="showTableGrid">
        <div class="table-grid">
          <div *ngFor="let row of tableGrid; let i = index" class="grid-row">
            <div *ngFor="let cell of row; let j = index" 
                 class="grid-cell" 
                 [class.highlighted]="cell.highlighted"
                 (mouseenter)="highlightCells(i, j)"
                 (click)="insertTableWithSize(i + 1, j + 1)">
            </div>
          </div>
        </div>
        <div class="table-info">{{selectedRows}} x {{selectedCols}} Table</div>
      </div>
    </div>

    <div class="toolbar" *ngIf="activeTab === 'layout'">
      <div class="toolbar-group">
        <label>Page Setup</label>
        <button class="layout-btn" (click)="changeOrientation()">üìÑ Orientation</button>
        <button class="layout-btn" (click)="changeMargins()">üìè Margins</button>
      </div>
    </div>

    <div class="toolbar" *ngIf="activeTab === 'view'">
      <div class="toolbar-group">
        <label>Zoom</label>
        <button class="view-btn" (click)="zoomIn()">üîç+ Zoom In</button>
        <button class="view-btn" (click)="zoomOut()">üîç- Zoom Out</button>
        <button class="view-btn" (click)="resetZoom()">‚Üª Reset</button>
      </div>
    </div>
  </div>

  <div class="document-area" (dragover)="onDragOver($event)" (drop)="onDrop($event)">
    <!-- Template Selection Modal -->
    <div class="template-modal" *ngIf="showTemplateModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Choose a Resume Template</h2>
          <button class="close-btn" (click)="closeTemplates()">√ó</button>
        </div>
        <div class="template-grid">
          <div class="template-card" (click)="selectTemplate('professional')">
            <div class="template-preview professional-preview">
              <div class="preview-header">YOUR NAME</div>
              <div class="preview-line"></div>
              <div class="preview-text"></div>
            </div>
            <p>Professional</p>
          </div>
          <div class="template-card" (click)="selectTemplate('modern')">
            <div class="template-preview modern-preview">
              <div class="preview-sidebar"></div>
              <div class="preview-content">
                <div class="preview-header">NAME</div>
                <div class="preview-text"></div>
              </div>
            </div>
            <p>Modern</p>
          </div>
          <div class="template-card" (click)="selectTemplate('creative')">
            <div class="template-preview creative-preview">
              <div class="preview-circle"></div>
              <div class="preview-header">YOUR NAME</div>
              <div class="preview-text"></div>
            </div>
            <p>Creative</p>
          </div>
          <div class="template-card" (click)="selectTemplate('minimal')">
            <div class="template-preview minimal-preview">
              <div class="preview-header">Name</div>
              <div class="preview-line-thin"></div>
              <div class="preview-text"></div>
            </div>
            <p>Minimal</p>
          </div>
        </div>
      </div>
    </div>

    <div class="page" contenteditable="true">
      <div class="resume-header" style="text-align: center; margin-bottom: 20px;">
        <h1 style="margin: 0; font-size: 28px; color: #2c3e50;" contenteditable="true">YOUR NAME</h1>
        <div class="contact-info" style="margin-top: 10px; font-size: 14px; color: #555;">
          <span contenteditable="true">üìß your.email@example.com</span> | 
          <span contenteditable="true">üì± +91 1234567890</span> | 
          <span contenteditable="true">üìç City, State</span>
        </div>
      </div>

      <div class="section" style="margin-bottom: 20px;">
        <h2 style="border-bottom: 2px solid #2c3e50; padding-bottom: 5px; color: #2c3e50;">PROFESSIONAL SUMMARY</h2>
        <p contenteditable="true" style="margin-top: 10px; line-height: 1.6;">Experienced professional with expertise in [your field]. Proven track record of [key achievements]. Seeking to leverage skills in [target role].</p>
      </div>

      <div class="section" style="margin-bottom: 20px;">
        <h2 style="border-bottom: 2px solid #2c3e50; padding-bottom: 5px; color: #2c3e50;">WORK EXPERIENCE</h2>
        <div style="margin-top: 10px;">
          <h3 contenteditable="true" style="margin: 10px 0 5px 0;">Job Title - Company Name</h3>
          <p contenteditable="true" style="font-style: italic; color: #666; margin: 0;">Month Year - Present</p>
          <ul style="margin-top: 5px; line-height: 1.6;">
            <li contenteditable="true">Achievement or responsibility 1</li>
            <li contenteditable="true">Achievement or responsibility 2</li>
            <li contenteditable="true">Achievement or responsibility 3</li>
          </ul>
        </div>
      </div>

      <div class="section" style="margin-bottom: 20px;">
        <h2 style="border-bottom: 2px solid #2c3e50; padding-bottom: 5px; color: #2c3e50;">EDUCATION</h2>
        <div style="margin-top: 10px;">
          <h3 contenteditable="true" style="margin: 10px 0 5px 0;">Degree Name - University Name</h3>
          <p contenteditable="true" style="font-style: italic; color: #666; margin: 0;">Graduation Year | CGPA/Percentage</p>
        </div>
      </div>

      <div class="section" style="margin-bottom: 20px;">
        <h2 style="border-bottom: 2px solid #2c3e50; padding-bottom: 5px; color: #2c3e50;">SKILLS</h2>
        <ul style="margin-top: 10px; line-height: 1.6; display: grid; grid-template-columns: 1fr 1fr; gap: 5px;">
          <li contenteditable="true">Technical Skill 1</li>
          <li contenteditable="true">Technical Skill 2</li>
          <li contenteditable="true">Technical Skill 3</li>
          <li contenteditable="true">Technical Skill 4</li>
        </ul>
      </div>

      <div class="section" style="margin-bottom: 20px;">
        <h2 style="border-bottom: 2px solid #2c3e50; padding-bottom: 5px; color: #2c3e50;">PROJECTS</h2>
        <div style="margin-top: 10px;">
          <h3 contenteditable="true" style="margin: 10px 0 5px 0;">Project Name</h3>
          <p contenteditable="true" style="line-height: 1.6;">Brief description of the project, technologies used, and your role in it.</p>
        </div>
      </div>

      <div id="dynamic-sections"></div>
    </div>
  </div>
</div>