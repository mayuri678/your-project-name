<app-header
  [loggedIn]="isLoggedIn"
  [showTemplates]="true"
  (logout)="logout()"
></app-header>

<div class="templates-container">
  <div class="templates-header">
    <h1>Resume Templates</h1>
    <p>Choose from our collection of professional resume templates. Filter by category, color, layout, and features to find the perfect template for your needs.</p>
  </div>

  <!-- Filters Section -->
  <div class="filters-section">
    <div class="filter-group">
      <label for="category-filter">Category:</label>
      <select id="category-filter" [(ngModel)]="selectedCategory" (change)="applyFilters()">
        <option *ngFor="let category of categories" [value]="category">{{ category }}</option>
      </select>
    </div>

    <div class="filter-group">
      <label for="color-filter">Color:</label>
      <select id="color-filter" [(ngModel)]="selectedColor" (change)="applyFilters()">
        <option *ngFor="let color of colors" [value]="color">{{ color | titlecase }}</option>
      </select>
    </div>

    <div class="filter-group">
      <label for="columns-filter">Columns:</label>
      <select id="columns-filter" [(ngModel)]="selectedColumns" (change)="applyFilters()">
        <option *ngFor="let column of columns" [value]="column">{{ column === 'All' ? 'All' : column + ' Column' + (column !== '1' ? 's' : '') }}</option>
      </select>
    </div>

    <div class="filter-group">
      <label for="headshot-filter">Photo:</label>
      <select id="headshot-filter" [(ngModel)]="selectedHeadshot" (change)="applyFilters()">
        <option *ngFor="let headshot of headshots" [value]="headshot">{{ headshot }}</option>
      </select>
    </div>
  </div>

  <!-- Results Summary -->
  <div class="results-summary">
    <span class="results-count">Showing {{ filteredTemplates.length }} template{{ filteredTemplates.length !== 1 ? 's' : '' }}</span>
    <span class="total-count">out of {{ allTemplates.length }} total</span>
  </div>

  <!-- Success Message -->
  <div *ngIf="showSuccessMessage" class="success-message">
    <span class="success-icon">‚úÖ</span>
    <span class="success-text">{{ successMessage }}</span>
  </div>

  <!-- Templates Table -->
  <div class="table-container">
    <table class="templates-table">
      <thead>
        <tr>
          <th>Template Name</th>
          <th>Category</th>
          <th>Color</th>
          <th>Layout</th>
          <th>Features</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let template of filteredTemplates" class="template-row">
          <td class="template-name">
            <div class="name-cell">
              <span class="template-title">{{ template.name }}</span>
              <span class="template-id">ID: {{ template.id }}</span>
            </div>
          </td>
          <td class="template-category">
            <span class="category-badge">{{ template.category }}</span>
          </td>
          <td class="template-color">
            <div class="color-indicator" [ngClass]="getColorClass(template.color)"></div>
            <span class="color-name">{{ template.color | titlecase }}</span>
          </td>
          <td class="template-layout">
            <span class="columns-info">{{ template.columns }} Column{{ template.columns > 1 ? 's' : '' }}</span>
          </td>
          <td class="template-features">
            <div class="features-list">
              <span *ngIf="template.hasHeadshot" class="feature-tag photo">üì∑ Photo</span>
              <span *ngIf="template.hasGraphics" class="feature-tag graphics">üé® Graphics</span>
              <span *ngIf="!template.hasHeadshot && !template.hasGraphics" class="feature-tag minimal">‚ú® Minimal</span>
            </div>
          </td>
          <td class="template-status">
            <span *ngIf="template.recommended" class="status-badge recommended">‚≠ê Recommended</span>
            <span *ngIf="!template.recommended" class="status-badge standard">Standard</span>
          </td>
          <td class="template-actions">
            
            <button class="action-btn edit-btn" (click)="editTemplate(template)" title="Edit Template">
              ‚úèÔ∏è Edit
            </button>
            
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- No Results Message -->
  <div *ngIf="filteredTemplates.length === 0" class="no-results">
    <div class="no-results-content">
      <h3>No templates found</h3>
      <p>Try adjusting your filters to see more templates.</p>
      <button class="reset-filters-btn" (click)="resetFilters()">Reset Filters</button>
    </div>
  </div>
</div>

<!-- Preview Modal -->
<div *ngIf="showPreviewModal" class="preview-modal-overlay" (click)="closePreviewModal()">
  <div class="preview-modal" (click)="$event.stopPropagation()">
    <div class="preview-modal-header">
      <h2>{{ selectedTemplate?.name }} - Preview</h2>
      <button class="close-modal-btn" (click)="closePreviewModal()">√ó</button>
    </div>
    <div class="preview-modal-content">
      <div class="template-preview">
        <div class="template-preview-image">
          <!-- Placeholder for template preview image -->
          <div class="template-placeholder" [ngClass]="'template-' + (selectedTemplate?.id || '1')">
            <div class="template-preview-header">
              <h3>{{ selectedTemplate?.name }}</h3>
              <div class="template-preview-meta">
                <span class="template-category">{{ selectedTemplate?.category }}</span>
                <span class="template-color" [ngClass]="'color-' + (selectedTemplate?.color || 'blue')"></span>
              </div>
            </div>
            <div class="template-preview-body">
              <div class="template-preview-sidebar" *ngIf="selectedTemplate?.columns === 2">
                <div class="preview-section">
                  <h4>Contact</h4>
                  <p>Email: {{ userEmail }}</p>
                  <p>Phone: {{ userPhone }}</p>
                </div>
                <div class="preview-section">
                  <h4>Skills</h4>
                  <ul>
                    <li>Skill 1</li>
                    <li>Skill 2</li>
                    <li>Skill 3</li>
                  </ul>
                </div>
              </div>
              <div class="template-preview-main">
                <div class="preview-section">
                  <h4>{{ userName }}</h4>
                  <p>{{ userEmail }}</p>
                </div>
                <div class="preview-section">
                  <h4>Professional Summary</h4>
                  <p>A brief summary of your professional background and skills.</p>
                </div>
                <div class="preview-section">
                  <h4>Experience</h4>
                  <div class="experience-item">
                    <h5>Job Title</h5>
                    <p>Company Name | 2020 - Present</p>
                    <p>Brief description of your role and achievements.</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="template-details">
          <h3>Template Details</h3>
          <div class="detail-item">
            <span class="detail-label">Category:</span>
            <span class="detail-value">{{ selectedTemplate?.category }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Color:</span>
            <span class="detail-value">{{ selectedTemplate?.color | titlecase }}</span>
            <span class="color-swatch" [ngClass]="'color-' + (selectedTemplate?.color || 'blue')"></span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Layout:</span>
            <span class="detail-value">{{ selectedTemplate?.columns }} Column{{ selectedTemplate?.columns > 1 ? 's' : '' }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-label">Features:</span>
            <div class="features-list">
              <span *ngIf="selectedTemplate?.hasHeadshot" class="feature-tag photo">üì∑ Photo</span>
              <span *ngIf="selectedTemplate?.hasGraphics" class="feature-tag graphics">üé® Graphics</span>
              <span *ngIf="!selectedTemplate?.hasHeadshot && !selectedTemplate?.hasGraphics" class="feature-tag minimal">‚ú® Minimal</span>
            </div>
          </div>
          <div class="preview-actions">
            <button class="cta-btn primary" (click)="selectTemplate(selectedTemplate)">
              ‚úèÔ∏è Use This Template
            </button>
            <button class="cta-btn secondary" (click)="closePreviewModal()">
              Close Preview
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
